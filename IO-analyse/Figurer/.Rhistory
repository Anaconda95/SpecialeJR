Storfeddata$exp_uni =       filter(mu_uni,      j==2018 | j==2026 | j==2030 | j==2040, i==1 | i==3 |i==5)$value/1000
Storfeddata$dispinc_uni=    filter(dispinc_uni, j==2018 | j==2026 | j==2030 | j==2040, i==1 | i==3 |i==5)$value/1000
Storfeddata$EVexp_uni =     filter(EVexp_uni,   t==2018 | t==2026 | t==2030 | t==2040, i==1 | i==3 |i==5)$EVexp_diff*100
Storfeddata$EVdispinc_uni = filter(EVdispinc_uni,   t==2018 | t==2026 | t==2030 | t==2040, i==1 | i==3 |i==5)$EVdispinc_diff*100
#diff
Storfeddata$w1_diff =        filter(w_diff,       k==2018 | k==2026 | k==2030 | k==2040, j==1, i==1 | i==3 |i==5)$value
Storfeddata$w5_diff =        filter(w_diff,       k==2018 | k==2026 | k==2030 | k==2040, j==5, i==1 | i==3 |i==5)$value
Storfeddata$exp_diff =       filter(mu_diff,      j==2018 | j==2026 | j==2030 | j==2040, i==1 | i==3 |i==5)$value/1000
Storfeddata$dispinc_diff=    filter(dispinc_diff, j==2018 | j==2026 | j==2030 | j==2040, i==1 | i==3 |i==5)$value/1000
Storfeddata$EVexp_diff =     filter(EVexp_diff,   t==2018 | t==2026 | t==2030 | t==2040, i==1 | i==3 |i==5)$EVexp_diff*100
Storfeddata$EVdispinc_diff = filter(EVdispinc_diff,   t==2018 | t==2026 | t==2030 | t==2040, i==1 | i==3 |i==5)$EVdispinc_diff*100
write.xlsx(Storfeddata,"storfedtabel.xlsx",)
# Lav en sammenligningstabel for w'erne
w_no
w_data = data.frame(Decile = c(rep(1,8),rep(3,8),rep(5,8)), Year = c(rep(c(2018,2026,2030,2040),3))     )
View(w_data)
w_data = data.frame(Decile = c(rep(1,3),rep(3,3),rep(5,3)), Year = c(rep(c(2018,2026,2030,2040),3))     )
w_data = data.frame(Decile = c(rep(1,4),rep(3,4),rep(5,4)), Year = c(rep(c(2018,2026,2030,2040),3))     )
View(w_data)
# Lav en sammenligningstabel for w'erne - ingen skatteændringer
w_no
# Lav en sammenligningstabel for w'erne - ingen skatteændringer
w_no = rgdx.param("notax_nog",'w_resul_t')
w_uni = rgdx.param("notax_unig",'w_resul_t')
w_diff = rgdx.param("notax_diffg",'w_resul_t')
Storfeddata$w1_no =        filter(w_no,       k==2018 | k==2030 | k==2040, j==1, i==1 | i==3 |i==5)$value
Storfeddata = data.frame(Decile = c(1,1,1,3,3,3,5,5,5), Year = c(rep(c(2018,2030,2040),3))     )
Storfeddata$w1_no =        filter(w_no,       k==2018 | k==2030 | k==2040, j==1, i==1 | i==3 |i==5)$value
wtab_data = data.frame(Decile = c(1,1,1,3,3,3,5,5,5), Year = c(rep(c(2018,2030,2040),3))     )
wtab_data$w1_no =        filter(w_no,       k==2018 | k==2030 | k==2040, j==1, i==1 | i==3 |i==5)$value
View(wtab_data)
wtab_data = data.frame(Decile = c(1,1,1,3,3,3,5,5,5), Year = c(rep(c(2018,2030,2040),3))     )
wtab_data$w1_no =        filter(w_no,       k==2018 | k==2030 | k==2040, j==1, i==1 | i==3 |i==5)$value
wtab_data$w1_uni =        filter(w_diff,       k==2018 | k==2030 | k==2040, j==1, i==1 | i==3 |i==5)$value
wtab_data$w1_diff =        filter(w_diff,       k==2018 | k==2030 | k==2040, j==1, i==1 | i==3 |i==5)$value
View(wtab_data)
w_no = rgdx.param("notax_nog",'w_resul_t')
w_uni = rgdx.param("notax_unig",'w_resul_t')
w_diff = rgdx.param("notax_diffg",'w_resul_t')
wtab_data = data.frame(Decile = c(1,1,1,3,3,3,5,5,5), Year = c(rep(c(2018,2030,2040),3))     )
wtab_data$w1_no =        filter(w_no,       k==2018 | k==2030 | k==2040, j==1, i==1 | i==3 |i==5)$value
wtab_data$w1_uni =        filter(w_diff,       k==2018 | k==2030 | k==2040, j==1, i==1 | i==3 |i==5)$value
wtab_data$w1_diff =        filter(w_diff,       k==2018 | k==2030 | k==2040, j==1, i==1 | i==3 |i==5)$value
View(wtab_data)
wtab_data = data.frame(Decile = c(1,1,1,3,3,3,5,5,5), Year = c(rep(c(2018,2030,2040),3))     )
wtab_data$w1_no =        filter(w_no,       k==2018 | k==2030 | k==2040, j==1, i==1 | i==3 |i==5)$value
wtab_data$w1_uni =        filter(w_uni,       k==2018 | k==2030 | k==2040, j==1, i==1 | i==3 |i==5)$value
wtab_data$w1_diff =        filter(w_diff,       k==2018 | k==2030 | k==2040, j==1, i==1 | i==3 |i==5)$value
View(wtab_data)
wtab_data$w1_no =          filter(w_no,       k==2018 | k==2030 | k==2040, j==1, i==1 | i==3 |i==5)$value
w_no = rgdx.param("notax_nog",'w_resul_t')
w_uni = rgdx.param("notax_unig",'w_resul_t')
w_diff = rgdx.param("notax_diffg",'w_resul_t')
wtab_data = data.frame(Decile = c(1,1,1,3,3,3,5,5,5), Year = c(rep(c(2018,2030,2040),3))     )
wtab_data$w1_no =          filter(w_no,       k==2018 | k==2030 | k==2040, j==1, i==1 | i==3 |i==5)$value
wtab_data$w2_no =          filter(w_no,       k==2018 | k==2030 | k==2040, j==2, i==1 | i==3 |i==5)$value
wtab_data$w3_no =          filter(w_no,       k==2018 | k==2030 | k==2040, j==3, i==1 | i==3 |i==5)$value
wtab_data$w4_no =          filter(w_no,       k==2018 | k==2030 | k==2040, j==4, i==1 | i==3 |i==5)$value
wtab_data$w5_no =          filter(w_no,       k==2018 | k==2030 | k==2040, j==5, i==1 | i==3 |i==5)$value
wtab_data$w6_no =          filter(w_no,       k==2018 | k==2030 | k==2040, j==6, i==1 | i==3 |i==5)$value
wtab_data$w7_no =          filter(w_no,       k==2018 | k==2030 | k==2040, j==7, i==1 | i==3 |i==5)$value
wtab_data$w8_no =          filter(w_no,       k==2018 | k==2030 | k==2040, j==8, i==1 | i==3 |i==5)$value
wtab_data$w1_uni =          filter(w_uni,       k==2018 | k==2030 | k==2040, j==1, i==1 | i==3 |i==5)$value
wtab_data$w2_uni =          filter(w_uni,       k==2018 | k==2030 | k==2040, j==2, i==1 | i==3 |i==5)$value
wtab_data$w3_uni =          filter(w_uni,       k==2018 | k==2030 | k==2040, j==3, i==1 | i==3 |i==5)$value
wtab_data$w4_uni =          filter(w_uni,       k==2018 | k==2030 | k==2040, j==4, i==1 | i==3 |i==5)$value
wtab_data$w5_uni =          filter(w_uni,       k==2018 | k==2030 | k==2040, j==5, i==1 | i==3 |i==5)$value
wtab_data$w6_uni =          filter(w_uni,       k==2018 | k==2030 | k==2040, j==6, i==1 | i==3 |i==5)$value
wtab_data$w7_uni =          filter(w_uni,       k==2018 | k==2030 | k==2040, j==7, i==1 | i==3 |i==5)$value
wtab_data$w8_uni =          filter(w_uni,       k==2018 | k==2030 | k==2040, j==8, i==1 | i==3 |i==5)$value
wtab_data$w1_diff =          filter(w_diff,       k==2018 | k==2030 | k==2040, j==1, i==1 | i==3 |i==5)$value
wtab_data$w2_diff =          filter(w_diff,       k==2018 | k==2030 | k==2040, j==2, i==1 | i==3 |i==5)$value
wtab_data$w3_diff =          filter(w_diff,       k==2018 | k==2030 | k==2040, j==3, i==1 | i==3 |i==5)$value
wtab_data$w4_diff =          filter(w_diff,       k==2018 | k==2030 | k==2040, j==4, i==1 | i==3 |i==5)$value
wtab_data$w5_diff =          filter(w_diff,       k==2018 | k==2030 | k==2040, j==5, i==1 | i==3 |i==5)$value
wtab_data$w6_diff =          filter(w_diff,       k==2018 | k==2030 | k==2040, j==6, i==1 | i==3 |i==5)$value
wtab_data$w7_diff =          filter(w_diff,       k==2018 | k==2030 | k==2040, j==7, i==1 | i==3 |i==5)$value
wtab_data$w8_diff =          filter(w_diff,       k==2018 | k==2030 | k==2040, j==8, i==1 | i==3 |i==5)$value
write.xlsx(wtab_data,"wtab.xlsx",)
c1=lm(log(Q1.Total.Consumption)~trend, data = realindkforb)
v <- indk_forb_kvint
#Indlæser data: RASMUS
priser<-read.csv("/Users/rasmuskaslund/Documents/GitHub/SpecialeJR /PRISDATA DST/PRISINDEKS.csv",sep=',')
df_h <-read.csv("/Users/rasmuskaslund/Documents/GitHub/SpecialeJR /PRISDATA DST/v8_decil_h.csv",sep=',')
df_1 <-read.csv("/Users/rasmuskaslund/Documents/GitHub/SpecialeJR /PRISDATA DST/v8_decil_1.csv",sep=',')
df_2 <-read.csv("/Users/rasmuskaslund/Documents/GitHub/SpecialeJR /PRISDATA DST/v8_decil_2.csv",sep=',')
df_3 <-read.csv("/Users/rasmuskaslund/Documents/GitHub/SpecialeJR /PRISDATA DST/v8_decil_3.csv",sep=',')
df_4 <-read.csv("/Users/rasmuskaslund/Documents/GitHub/SpecialeJR /PRISDATA DST/v8_decil_4.csv",sep=',')
df_5 <-read.csv("/Users/rasmuskaslund/Documents/GitHub/SpecialeJR /PRISDATA DST/v8_decil_5.csv",sep=',')
df_6 <-read.csv("/Users/rasmuskaslund/Documents/GitHub/SpecialeJR /PRISDATA DST/v8_decil_6.csv",sep=',')
df_7 <-read.csv("/Users/rasmuskaslund/Documents/GitHub/SpecialeJR /PRISDATA DST/v8_decil_7.csv",sep=',')
df_8 <-read.csv("/Users/rasmuskaslund/Documents/GitHub/SpecialeJR /PRISDATA DST/v8_decil_8.csv",sep=',')
df_9 <-read.csv("/Users/rasmuskaslund/Documents/GitHub/SpecialeJR /PRISDATA DST/v8_decil_9.csv",sep=',')
df_10<-read.csv("/Users/rasmuskaslund/Documents/GitHub/SpecialeJR /PRISDATA DST/v8_decil_10.csv",sep=',')
disp_indk <- read.xlsx("/Users/rasmuskaslund/Documents/GitHub/SpecialeJR /Data/Disponibel indkomst tidsserie.xlsx",1)
disp_indk <- disp_indk[order(disp_indk$Aar),]
#Lav kvintiler
kvint_1 <- (df_1+df_2)/2
kvint_2 <- (df_3+df_4)/2
kvint_3 <- (df_5+df_6)/2
kvint_4 <- (df_7+df_8)/2
kvint_5 <- (df_9+df_10)/2
indk_forb_kvint <- data.frame(Year=c(1994:2019), Dispk1=(disp_indk$X1..decil+disp_indk$X2..decil)/2,
Dispk2=(disp_indk$X3..decil+disp_indk$X4..decil)/2,
Dispk3=(disp_indk$X5..decil+disp_indk$X6..decil)/2,
Dispk4=(disp_indk$X7..decil+disp_indk$X8..decil)/2,
Dispk5=(disp_indk$X9..decil+disp_indk$X10..decil)/2,
Forbk1=kvint_1$ialt, Forbk2=kvint_2$ialt, Forbk3=kvint_3$ialt, Forbk4=kvint_4$ialt, Forbk5=kvint_5$ialt    )
prisindeksdata <- read.xlsx("/Users/rasmuskaslund/Documents/GitHub/SpecialeJR /Data/prisindeks.xlsx", 1)
v <- indk_forb_kvint
v2 <- data.frame(Year=v$Year, Q1.Disposable.Income = v$Dispk1,Q2.Disposable.Income = v$Dispk2,
Q3.Disposable.Income = v$Dispk3,Q4.Disposable.Income = v$Dispk4, Q5.Disposable.Income = v$Dispk5,
Q1.Total.Consumption = v$Forbk1, Q2.Total.Consumption = v$Forbk2, Q3.Total.Consumption = v$Forbk3,
Q4.Total.Consumption = v$Forbk4, Q5.Total.Consumption = v$Forbk5)
head(v2)
prisindeksdata$Prisindeks_2015
v2=v2/prisindeksdata$Prisindeks_2015
v2$Year=c(1994:2019)
v2$Q1.Disposable.Income[26]/v2$Q1.Disposable.Income[1]
v2$Q5.Disposable.Income[26]/v2$Q5.Disposable.Income[1]
v2$Q1.Total.Consumption[26]/v2$Q1.Total.Consumption[1]
v2$Q5.Total.Consumption[26]/v2$Q5.Total.Consumption[1]
#LAVER LIGE EN FED lineær MODEL for fremskrivning af forbrug og indkomst
realindkforb = v2
head(realindkforb)
realindkforb$trend=c(1:26)
realindkforb$Q6.Total.Consumption = df_h$ialt/prisindeksdata$Prisindeks_2015
realindkforb$Q6.Disposable.Income = disp_indk$Hele.landet/prisindeksdata$Prisindeks_2015
c1=lm(log(Q1.Total.Consumption)~trend, data = realindkforb)
c2=lm(log(Q2.Total.Consumption)~trend, data = realindkforb)
c3=lm(log(Q3.Total.Consumption)~trend, data = realindkforb)
c4=lm(log(Q4.Total.Consumption)~trend, data = realindkforb)
c5=lm(log(Q5.Total.Consumption)~trend, data = realindkforb)
c6=lm(log(Q6.Total.Consumption)~trend, data = realindkforb)
i1=lm(log(Q1.Disposable.Income)~trend, data = realindkforb)
i2=lm(log(Q2.Disposable.Income)~trend, data = realindkforb)
i3=lm(log(Q3.Disposable.Income)~trend, data = realindkforb)
i4=lm(log(Q4.Disposable.Income)~trend, data = realindkforb)
i5=lm(log(Q5.Disposable.Income)~trend, data = realindkforb)
i6=lm(log(Q6.Disposable.Income)~trend, data = realindkforb)
rbind(c1$coefficients[2],c2$coefficients[2],c3$coefficients[2],c4$coefficients[2],c5$coefficients[2],c6$coefficients[2])
rbind(i1$coefficients[2],i2$coefficients[2],i3$coefficients[2],i4$coefficients[2],i5$coefficients[2],i6$coefficients[2])
trends= data.frame(cons=rbind(c1$coefficients[2],c2$coefficients[2],c3$coefficients[2],c4$coefficients[2],c5$coefficients[2],c6$coefficients[2]),
dispinc=rbind(i1$coefficients[2],i2$coefficients[2],i3$coefficients[2],i4$coefficients[2],i5$coefficients[2],i6$coefficients[2]) )
View(trends)
trends= data.frame(cons=c(c1$coefficients[2],c2$coefficients[2],c3$coefficients[2],c4$coefficients[2],c5$coefficients[2],c6$coefficients[2]),
dispinc=c(i1$coefficients[2],i2$coefficients[2],i3$coefficients[2],i4$coefficients[2],i5$coefficients[2],i6$coefficients[2]) )
View(trends)
write.xlsx(trends,"trends.xlsx",)
v2$Q1.Disposable.Income[26]/v2$Q1.Disposable.Income[1]
v2$Q5.Disposable.Income[26]/v2$Q5.Disposable.Income[1]
v2$Q1.Total.Consumption[26]/v2$Q1.Total.Consumption[1]
v2$Q5.Total.Consumption[26]/v2$Q5.Total.Consumption[1]
v <- indk_forb_kvint
v2 <- data.frame(Year=v$Year, Q1.Disposable.Income = v$Dispk1,Q2.Disposable.Income = v$Dispk2,
Q3.Disposable.Income = v$Dispk3,Q4.Disposable.Income = v$Dispk4, Q5.Disposable.Income = v$Dispk5,
Q1.Total.Consumption = v$Forbk1, Q2.Total.Consumption = v$Forbk2, Q3.Total.Consumption = v$Forbk3,
Q4.Total.Consumption = v$Forbk4, Q5.Total.Consumption = v$Forbk5)
head(v2)
prisindeksdata$Prisindeks_2015
v2=v2/prisindeksdata$Prisindeks_2015
v2$Year=c(1994:2019)
v2$Q1.Disposable.Income[26]/v2$Q1.Disposable.Income[1]
v2$Q5.Disposable.Income[26]/v2$Q5.Disposable.Income[1]
v2$Q1.Total.Consumption[26]/v2$Q1.Total.Consumption[1]
v2$Q5.Total.Consumption[26]/v2$Q5.Total.Consumption[1]
(v2$Q5.Total.Consumption[26]/v2$Q5.Total.Consumption[1])^(1/26)
(v2$Q1.Disposable.Income[26]/v2$Q1.Disposable.Income[1])^(1/26)
(v2$Q5.Disposable.Income[26]/v2$Q5.Disposable.Income[1])^(1/26)
(v2$Q1.Total.Consumption[26]/v2$Q1.Total.Consumption[1])^(1/26)
(v2$Q5.Total.Consumption[26]/v2$Q5.Total.Consumption[1])^(1/26)
((v2$Q1.Disposable.Income[26]/v2$Q1.Disposable.Income[1])^(1/26)-1)*100
((v2$Q5.Disposable.Income[26]/v2$Q5.Disposable.Income[1])^(1/26)-1)*100
((v2$Q1.Total.Consumption[26]/v2$Q1.Total.Consumption[1])^(1/26)-1)*100
((v2$Q1.Disposable.Income[26]/v2$Q1.Disposable.Income[1])^(1/26)-1)*100
((v2$Q5.Disposable.Income[26]/v2$Q5.Disposable.Income[1])^(1/26)-1)*100
((v2$Q1.Total.Consumption[26]/v2$Q1.Total.Consumption[1])^(1/26)-1)*100
((v2$Q5.Total.Consumption[26]/v2$Q5.Total.Consumption[1])^(1/26)-1)*100
c1=lm(log(Q1.Total.Consumption)~trend, data = realindkforb)
c2=lm(log(Q2.Total.Consumption)~trend, data = realindkforb)
c3=lm(log(Q3.Total.Consumption)~trend, data = realindkforb)
c4=lm(log(Q4.Total.Consumption)~trend, data = realindkforb)
c5=lm(log(Q5.Total.Consumption)~trend, data = realindkforb)
c6=lm(log(Q6.Total.Consumption)~trend, data = realindkforb)
i1=lm(log(Q1.Disposable.Income)~trend, data = realindkforb)
i2=lm(log(Q2.Disposable.Income)~trend, data = realindkforb)
i3=lm(log(Q3.Disposable.Income)~trend, data = realindkforb)
i4=lm(log(Q4.Disposable.Income)~trend, data = realindkforb)
i5=lm(log(Q5.Disposable.Income)~trend, data = realindkforb)
i6=lm(log(Q6.Disposable.Income)~trend, data = realindkforb)
trends= data.frame(cons=c(c1$coefficients[2],c2$coefficients[2],c3$coefficients[2],c4$coefficients[2],c5$coefficients[2],c6$coefficients[2]),
dispinc=c(i1$coefficients[2],i2$coefficients[2],i3$coefficients[2],i4$coefficients[2],i5$coefficients[2],i6$coefficients[2]) )
View(trends)
w_uni = rgdx.param("notax_unig",'w_resul_t')
c1
write.xlsx(realindkforb,"realindkforb.xlsx",)
# dekomponer CS på varer frem 1250 -----------
CS_g_exp     <- rgdx.param("frem1250_decomposeCD",'CS_g_exp')
# dekomponer CS på varer frem 1250 -----------
CS_g_exp     <- rgdx.param("frem1250_decomposeCS",'CS_g_exp')
View(CS_g_exp)
CS_g_exp$CS_g_exp =CS_g_exp$CS_g_exp*100
CS_g_exp = filter(CS_g_exp, t==2030)
CS_g_exp = filter(CS_g_exp, t==2030, i<6)
CS_g_exp = filter(CS_g_exp, t==2030, i=<5)
CS_g_exp = filter(CS_g_exp, t==2030, i<=5)
# dekomponer CS på varer frem 1250 -----------
CS_g_exp     <- rgdx.param("frem1250_decomposeCS",'CS_g_exp')
CS_g_exp$CS_g_exp =CS_g_exp$CS_g_exp*100
CS_g_exp = filter(CS_g_exp, t==2030, i<=5)
CS_g_exp = filter(CS_g_exp, t==2030, i!=6)
# dekomponer CS på varer frem 1250 -----------
CS_g_exp     <- rgdx.param("frem1250_decomposeCS",'CS_g_exp')
CS_g_exp$CS_g_exp =CS_g_exp$CS_g_exp*100
CS_g_exp = filter(CS_g_exp, t==2030, i!=6)
v=CS_g_exp
ggplot(v, aes(fill=g, y=CS_g_exp, x=i)) +
geom_bar(position="dodge", stat="identity")
ggplot(v, aes(fill=g, y=CS_g_exp, x=i)) +
geom_bar(position="stack", stat="identity")
CS_g_exp$CS_g_exp =-CS_g_exp$CS_g_exp*100
# dekomponer CS på varer frem 1250 -----------
CS_g_exp     <- rgdx.param("frem1250_decomposeCS",'CS_g_exp')
CS_g_exp$CS_g_exp =-CS_g_exp$CS_g_exp*100
CS_g_exp = filter(CS_g_exp, t==2030, i!=6)
v=CS_g_exp
ggplot(v, aes(fill=g, y=CS_g_exp, x=i)) +
geom_bar(position="stack", stat="identity")
ggplot(v, aes(fill=g, y=CS_g_exp, x=i)) +
geom_bar(position="stack", stat="identity")+
scale_color_manual(values = wes_palette("Rushmore", 8, type = "continuous"))
ggplot(v, aes(fill=g, y=CS_g_exp, x=i)) +
geom_bar(position="stack", stat="identity")+
scale_color_manual(values = wes_palette("Rushmore", 8, type = "continuous"))
ggplot(v, aes(fill=g, y=CS_g_exp, x=i)) + theme_bw()  +
geom_bar(position="stack", stat="identity")+
scale_fill_manual(values = wes_palette("Rushmore", 8, type = "continuous"))
ggplot(v, aes(fill=g, y=CS_g_exp, x=i)) + theme_bw()  +
geom_bar(position="stack", stat="identity", color="black")+
scale_fill_manual(values = wes_palette("Rushmore", 8, type = "continuous"))
ggplot(v, aes(fill=g, y=CS_g_exp, x=i)) + theme_bw()  +
geom_bar(position="stack", stat="identity", color="darkgrey")+
scale_fill_manual(values = wes_palette("Rushmore", 8, type = "continuous"))
ggplot(v, aes(fill=g, y=CS_g_exp, x=i)) + theme_bw()  +
geom_bar(position="stack", stat="identity", color="bisque4")+
scale_fill_manual(values = wes_palette("Rushmore", 8, type = "continuous"))
ggplot(v, aes(fill=g, y=CS_g_exp, x=i)) + theme_bw()  +
geom_bar(position="stack", stat="identity", color="162")+
scale_fill_manual(values = wes_palette("Rushmore", 8, type = "continuous"))
ggplot(v, aes(fill=g, y=CS_g_exp, x=i)) + theme_bw()  +
geom_bar(position="stack", stat="identity", color="222")+
scale_fill_manual(values = wes_palette("Rushmore", 8, type = "continuous"))
ggplot(v, aes(fill=g, y=CS_g_exp, x=i)) + theme_bw()  +
geom_bar(position="stack", stat="identity", color="999")+
scale_fill_manual(values = wes_palette("Rushmore", 8, type = "continuous"))
ggplot(v, aes(fill=g, y=CS_g_exp, x=i)) + theme_bw()  +
geom_bar(position="stack", stat="identity", color="222222")+
scale_fill_manual(values = wes_palette("Rushmore", 8, type = "continuous"))
ggplot(v, aes(fill=g, y=CS_g_exp, x=i)) + theme_bw()  +
geom_bar(position="stack", stat="identity", color="#222222")+
scale_fill_manual(values = wes_palette("Rushmore", 8, type = "continuous"))
ggplot(v, aes(fill=g, y=CS_g_exp, x=i)) + theme_bw()  +
geom_bar(position=position_fill(reverse = TRUE), stat="identity", color="#222222")+
scale_fill_manual(values = wes_palette("Rushmore", 8, type = "continuous"))
ggplot(v, aes(fill=g, y=CS_g_exp, x=i)) + theme_bw()  +
geom_bar(position=position_stack(reverse = TRUE), stat="identity", color="#222222")+
scale_fill_manual(values = wes_palette("Rushmore", 8, type = "continuous"))
v$Composite = c(rep(c("1: Meat and dairy","2: Other foods","3: Housing","4: Energy for housing","5: Energy for transport","6: Transport","7: Other goods","8: Other services") , 5))
v
colnames(v)= c("Quintile","g","t","Pct.","Composite")
ggplot(v, aes(fill=g, y=CS_g_exp, x=i)) + theme_bw()  +
geom_bar(position=position_stack(reverse = TRUE), stat="identity", color="#222222")+
scale_fill_manual(values = wes_palette("Rushmore", 8, type = "continuous"))
ggplot(v, aes(fill=Composite, y=value, x=Quintile)) + theme_bw()  +
geom_bar(position=position_stack(reverse = TRUE), stat="identity", color="#222222")+
scale_fill_manual(values = wes_palette("Rushmore", 8, type = "continuous"))
colnames(v)= c("Quintile","g","t","value","Composite")
ggplot(v, aes(fill=Composite, y=value, x=Quintile)) + theme_bw()  +
geom_bar(position=position_stack(reverse = TRUE), stat="identity", color="#222222")+
scale_fill_manual(values = wes_palette("Rushmore", 8, type = "continuous"))
ggplot(v, aes(fill=Composite, y=value, x=Quintile)) + theme_bw()  +
geom_bar(position=position_stack(reverse = TRUE), stat="identity", color="#222222")+
scale_fill_manual(values = wes_palette("Rushmore", 8, type = "continuous"))+
labs(y = "Pct. of total expenditure")
ggsave(
"cs_decomposed.pdf",
plot = plottelotte,
device="pdf",
width =6 ,
height = 4,
units = c("in", "cm", "mm"),
dpi = 300,
limitsize = TRUE,
)
plottelotte <- ggplot(v, aes(fill=Composite, y=value, x=Quintile)) + theme_bw()  +
geom_bar(position=position_stack(reverse = TRUE), stat="identity", color="#222222")+
scale_fill_manual(values = wes_palette("Rushmore", 8, type = "continuous"))+
labs(y = "Pct. of total expenditure")
ggsave(
"cs_decomposed.pdf",
plot = plottelotte,
device="pdf",
width =6 ,
height = 4,
units = c("in", "cm", "mm"),
dpi = 300,
limitsize = TRUE,
)
plottelotte <- ggplot(v, aes(fill=Composite, y=value, x=Quintile)) + theme_bw()  +
geom_bar(position=position_stack(reverse = TRUE), stat="identity", color="#222222", size=0.5)+
scale_fill_manual(values = wes_palette("Rushmore", 8, type = "continuous"))+
labs(y = "Pct. of total expenditure")
ggsave(
"cs_decomposed.pdf",
plot = plottelotte,
device="pdf",
width =6 ,
height = 4,
units = c("in", "cm", "mm"),
dpi = 300,
limitsize = TRUE,
)
ggplot(v, aes(fill=Composite, y=value, x=Quintile)) + theme_bw()  +
geom_bar(position=position_stack(reverse = TRUE), stat="identity", color="#222222", size=0.5)+
scale_fill_manual(values = wes_palette("Rushmore", 8, type = "continuous"))+
labs(y = "Pct. of total expenditure")
plottelotte <- ggplot(v, aes(fill=Composite, y=value, x=Quintile)) + theme_bw()  +
geom_bar(position=position_stack(reverse = TRUE), stat="identity", color="#222222", size=0.1)+
scale_fill_manual(values = wes_palette("Rushmore", 8, type = "continuous"))+
labs(y = "Pct. of total expenditure")
ggsave(
"cs_decomposed.pdf",
plot = plottelotte,
device="pdf",
width =6 ,
height = 4,
units = c("in", "cm", "mm"),
dpi = 300,
limitsize = TRUE,
)
plottelotte <- ggplot(v, aes(fill=Composite, y=value, x=Quintile)) + theme_bw()  +
geom_bar(position=position_stack(reverse = TRUE), stat="identity", color="#222222", size=0.25)+
scale_fill_manual(values = wes_palette("Rushmore", 8, type = "continuous"))+
labs(y = "Pct. of total expenditure")
ggsave(
"cs_decomposed.pdf",
plot = plottelotte,
device="pdf",
width =6 ,
height = 4,
units = c("in", "cm", "mm"),
dpi = 300,
limitsize = TRUE,
)
# dekomponer CS på varer frem 1250 -----------
CS_g_exp     <- rgdx.param("frem1250_decomposeCS",'CS_g_exp')
CS_g_exp$CS_g_exp =-CS_g_exp$CS_g_exp*100
CS_g_exp = filter(CS_g_exp, t==2030, i!=6)
CS_g_inc     <- rgdx.param("frem1250_decomposeCS",'CS_g_inc')
CS_g_inc$CS_g_inc =-CS_g_inc$CS_g_inc*100
CS_g_inc = filter(CS_g_inc, t==2030, i!=6)
v=CS_g_exp
v$Composite = c(rep(c("1: Meat and dairy","2: Other foods","3: Housing","4: Energy for housing","5: Energy for transport","6: Transport","7: Other goods","8: Other services") , 5))
colnames(v)= c("Quintile","g","t","value","Composite")
plotexp <- ggplot(v, aes(fill=Composite, y=value, x=Quintile)) + theme_bw()  +
geom_bar(position=position_stack(reverse = TRUE), stat="identity", color="#222222", size=0.25)+
scale_fill_manual(values = wes_palette("Rushmore", 8, type = "continuous"))+
labs(y = "Pct. of total expenditure")
v=CS_g_exp
v$Composite = c(rep(c("1: Meat and dairy","2: Other foods","3: Housing","4: Energy for housing","5: Energy for transport","6: Transport","7: Other goods","8: Other services") , 5))
colnames(v)= c("Quintile","g","t","value","Composite")
plotinc<- ggplot(v, aes(fill=Composite, y=value, x=Quintile)) + theme_bw()  +
geom_bar(position=position_stack(reverse = TRUE), stat="identity", color="#222222", size=0.25)+
scale_fill_manual(values = wes_palette("Rushmore", 8, type = "continuous"))+
labs(y = "Pct. of total expenditure")
ggsave(
"cs_decomposed_exp.pdf",
plot = plotexp,
device="pdf",
width =6 ,
height = 4,
units = c("in", "cm", "mm"),
dpi = 300,
limitsize = TRUE,
)
ggsave(
"cs_decomposed_inc.pdf",
plot = plotexp,
device="pdf",
width =6 ,
height = 4,
units = c("in", "cm", "mm"),
dpi = 300,
limitsize = TRUE,
)
ggsave(
"cs_decomposed_inc.pdf",
plot = plotinc,
device="pdf",
width =6 ,
height = 4,
units = c("in", "cm", "mm"),
dpi = 300,
limitsize = TRUE,
)
# dekomponer CS på varer frem 1250 -----------
CS_g_exp     <- rgdx.param("frem1250_decomposeCS",'CS_g_exp')
CS_g_exp$CS_g_exp =-CS_g_exp$CS_g_exp*100
CS_g_exp = filter(CS_g_exp, t==2030, i!=6)
CS_g_inc     <- rgdx.param("frem1250_decomposeCS",'CS_g_inc')
CS_g_inc$CS_g_inc =-CS_g_inc$CS_g_inc*100
CS_g_inc = filter(CS_g_inc, t==2030, i!=6)
v=CS_g_exp
v$Composite = c(rep(c("1: Meat and dairy","2: Other foods","3: Housing","4: Energy for housing","5: Energy for transport","6: Transport","7: Other goods","8: Other services") , 5))
colnames(v)= c("Quintile","g","t","value","Composite")
plotexp <- ggplot(v, aes(fill=Composite, y=value, x=Quintile)) + theme_bw()  +
geom_bar(position=position_stack(reverse = TRUE), stat="identity", color="#222222", size=0.25)+
scale_fill_manual(values = wes_palette("Rushmore", 8, type = "continuous"))+
labs(y = "Pct. of total expenditure")
v=CS_g_inc
v$Composite = c(rep(c("1: Meat and dairy","2: Other foods","3: Housing","4: Energy for housing","5: Energy for transport","6: Transport","7: Other goods","8: Other services") , 5))
colnames(v)= c("Quintile","g","t","value","Composite")
plotinc<- ggplot(v, aes(fill=Composite, y=value, x=Quintile)) + theme_bw()  +
geom_bar(position=position_stack(reverse = TRUE), stat="identity", color="#222222", size=0.25)+
scale_fill_manual(values = wes_palette("Rushmore", 8, type = "continuous"))+
labs(y = "Pct. of total expenditure")
ggsave(
"cs_decomposed_exp.pdf",
plot = plotexp,
device="pdf",
width =6 ,
height = 4,
units = c("in", "cm", "mm"),
dpi = 300,
limitsize = TRUE,
)
ggsave(
"cs_decomposed_inc.pdf",
plot = plotinc,
device="pdf",
width =6 ,
height = 4,
units = c("in", "cm", "mm"),
dpi = 300,
limitsize = TRUE,
)
CSdecomplst = list(plotexp,ploinc)
CSdecomplst = list(plotexp,plotinc)
groupplot <- ggarrange(plotlist=CSdecomplst, ncol=2, nrow=1, common.legend = TRUE, legend="right")
ggsave(
"cs_decomposed_grouped.pdf",
plot = groupplot,
device="pdf",
width =6 ,
height = 4,
units = c("in", "cm", "mm"),
dpi = 300,
limitsize = TRUE,
)
# dekomponer CS på varer frem 1250 -----------
CS_g_exp     <- rgdx.param("frem1250_decomposeCS",'CS_g_exp')
CS_g_exp$CS_g_exp =-CS_g_exp$CS_g_exp*100
CS_g_exp = filter(CS_g_exp, t==2030, i!=6)
CS_g_inc     <- rgdx.param("frem1250_decomposeCS",'CS_g_inc')
CS_g_inc$CS_g_inc =-CS_g_inc$CS_g_inc*100
CS_g_inc = filter(CS_g_inc, t==2030, i!=6)
v=CS_g_exp
v$Composite = c(rep(c("1: Meat and dairy","2: Other foods","3: Housing","4: Energy for housing","5: Energy for transport","6: Transport","7: Other goods","8: Other services") , 5))
colnames(v)= c("Quintile","g","t","value","Composite")
plotexp <- ggplot(v, aes(fill=Composite, y=value, x=Quintile)) + theme_bw()  +
geom_bar(position=position_stack(reverse = TRUE), stat="identity", color="#222222", size=0.25)+
scale_fill_manual(values = wes_palette("Rushmore", 8, type = "continuous"))+
labs(y = "Pct. of total expenditure")
v=CS_g_inc
v$Composite = c(rep(c("1: Meat and dairy","2: Other foods","3: Housing","4: Energy for housing","5: Energy for transport","6: Transport","7: Other goods","8: Other services") , 5))
colnames(v)= c("Quintile","g","t","value","Composite")
plotinc<- ggplot(v, aes(fill=Composite, y=value, x=Quintile)) + theme_bw()  +
geom_bar(position=position_stack(reverse = TRUE), stat="identity", color="#222222", size=0.25)+
scale_fill_manual(values = wes_palette("Rushmore", 8, type = "continuous"))+
labs(y = "Pct. of disposable income")
CSdecomplst = list(plotexp,plotinc)
groupplot <- ggarrange(plotlist=CSdecomplst, ncol=2, nrow=1, common.legend = TRUE, legend="right")
ggsave(
"cs_decomposed_exp.pdf",
plot = plotexp,
device="pdf",
width =6 ,
height = 4,
units = c("in", "cm", "mm"),
dpi = 300,
limitsize = TRUE,
)
ggsave(
"cs_decomposed_inc.pdf",
plot = plotinc,
device="pdf",
width =6 ,
height = 4,
units = c("in", "cm", "mm"),
dpi = 300,
limitsize = TRUE,
)
ggsave(
"cs_decomposed_grouped.pdf",
plot = groupplot,
device="pdf",
width =6 ,
height = 4,
units = c("in", "cm", "mm"),
dpi = 300,
limitsize = TRUE,
)
